{% extends "base.html" %}

{% block title %}
{{ movie.title_orig }}
{% endblock %}

{% block content %}
<h1>{{hotel.name}} </h1>
<div class="hotel-details">
    <div class="hotel-avg-rating">Průměrné hodnocení:
        {% if avg_rating %}
            {{ avg_rating.rating__avg |floatformat:"0"}}
        {% else %}
            Dosud nehodnoceno
        {% endif %}
    </div>
    <div class="name">Hotel: {{ hotel.name }}</div>
    <div id="star-rating">Počet hvězdiček: {{ hotel.star_rating }}</div>
    <div id="hotel-city">Město: {{ hotel.city }}</div>
    <div id="hotel-country">Stát: {{ hotel.city.country }}</div>
    <div class="images">
        {% for image in images %}
        <div class="image-container"><img src="{{ image.image.url }}" width="150px"></div>
        {% endfor %}
    </div>
    <div id="hotel-description">Popis: {{ hotel.description }}</div>
    </div>
    {% if request.user.is_authenticated %}
        {% if user_rating %}
            Vaše hodnocení je: {{ user_rating.rating }}
        {% endif %}
        <form method="post" action="{% url 'rate_hotel' %}">
            {% csrf_token %}
            <label for="rating">Hodnocení hotelu (0-100):</label>
            <input type="number" id="rating" name="rating" min="0" max="100">
            <input type="hidden" name="hotel_id" value="{{ hotel.id }}">
            <input type="submit">
        </form>
        {% if perms.viewer.change_hotel %}
            <a href="{% url 'hotel_update' hotel.id %}"><button>Upravit</button></a>
        {% endif %}
        {% if perms.viewer.delete_hotel %}
            <a href="{% url 'hotel_delete' hotel.id %}"><button>Smazat</button></a>
        {% endif %}
    {% endif %}

    {% if request.user.is_authenticated %}
    <form action="{% url 'add_comment' %}" method="post">
        {% csrf_token %}
        <label for="rating">Pridat komentar:</label>
        <div>
            <textarea name="comment" cols="100" rows="5"></textarea>
        </div>
        <input type="hidden" name="hotel_id" value="{{ hotel.id }}">
        <input type="submit" value="Odeslat komentar">
    </form>
    {% endif %}

    <h3>Komentáře k hotelu:</h3>
    {% for comment in comments %}
        <p>
            <h6><strong>{{ comment.user }}</strong></h6>
            <h6>{{ comment.created }}</h6>
            {{ comment.comment }}
        </p>
        <hr>
    {% empty %}
        Zatím žádný komentář.

    {% endfor %}
</div>
{% endblock %}
